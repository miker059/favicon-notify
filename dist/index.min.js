!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(t="undefined"!=typeof globalThis?globalThis:t||self).FaviconNotify=o()}(this,(function(){"use strict";var t=function(){return t=Object.assign||function(t){for(var o,i=1,n=arguments.length;i<n;i++)for(var e in o=arguments[i])Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e]);return t},t.apply(this,arguments)};return function(){function o(o,i){void 0===o&&(o={});this.options=t(t({},{faviconUrl:"/favicon.ico",labelColor:"#ff0000",labelSize:70,labelOffset:5,textColor:"#ffffff",fontSize:80,fontFamily:"Arial",fontStyle:"normal",fontWeight:"bold",fontVOffset:4,withCounter:!1,startCounterValue:0}),o),this.forceNotCount=!1,this.readyCallback=null,this.icoLoaded=!1,this.counter=this.options.startCounterValue,i?(this.favicon=i,this.options.faviconUrl=this.favicon.href):(this.favicon=document.createElement("link"),this.favicon.rel="icon",this.favicon.type="image/x-icon"),this.ico=new Image,this.ico.crossOrigin="Anonymous",this.ico.src=this.options.faviconUrl,this.init()}return o.prototype.init=function(){var t=this;this.ico.addEventListener("load",(function(){t.icoLoaded=!0,t.favicon.href=t.ico.src,document.getElementsByTagName("head")[0].appendChild(t.favicon),null!==t.readyCallback&&t.readyCallback()}))},o.prototype.drawIcon=function(){if(!this.icoLoaded)throw new Error("Favicon not loaded");if(!this.counter&&this.forceNotCount)return this.ico.src;var t=document.createElement("canvas");t.width=this.ico.width,t.height=this.ico.height;var o=t.getContext("2d"),i=t.width,n=t.height,e=i*this.options.labelSize/100,r=i*this.options.labelOffset/100,a=i-e/2+r,s=n-e/2+r,c=e/2-r,h=2*c*this.options.fontSize/100;if(!o)throw new Error("<canvas> not supported!");if(o.clearRect(0,0,i,n),o.beginPath(),o.fillStyle=this.options.labelColor,o.arc(a,s,c,0,2*Math.PI),o.fill(),o.closePath(),this.options.withCounter){!this.forceNotCount&&this.counter++;var f=this.counter<100?this.counter.toString():"99+";o.textAlign="center",o.textBaseline="middle",o.font="".concat(this.options.fontWeight," ").concat(this.options.fontStyle," ").concat(h,"px ").concat(this.options.fontFamily),o.fillStyle=this.options.textColor,o.fillText(f,a,s+this.options.fontVOffset,h)}var l=new Path2D;return l.moveTo(0,0),l.lineTo(i,0),l.lineTo(i,s),l.arc(a,s,e/2,0,Math.PI/2,!0),l.lineTo(0,n),o.clip(l),o.drawImage(this.ico,0,0),t.toDataURL()},o.prototype.addFavicon=function(t){this.favicon&&(this.favicon.href=t)},o.prototype.ready=function(t){this.readyCallback=t},o.prototype.add=function(t){return void 0===t&&(t=!1),this.forceNotCount=t,this.addFavicon(this.drawIcon()),this},o.prototype.setCounter=function(t){return this.counter=t,this.add(!0),this},o.prototype.remove=function(t){return void 0===t&&(t=!1),this.forceNotCount=t,!t&&(this.counter=0),this.addFavicon(this.ico.src),this},o}()}));
//# sourceMappingURL=index.min.js.map
